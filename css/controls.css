/* controls.css */

/* CONTROLS AND SELECT STYLING */
.controls {
    margin-bottom: 2rem;
}

.control-group {
    margin-bottom: 1rem;
}

.control-group label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: var(--text-secondary, rgba(255, 255, 255, 0.9)); /* Fallback */
}

/* UPDATED: Enhanced select styling for cross-browser compatibility */
.control-group select {
    width: 100%;
    background: var(--input-bg, rgba(255, 255, 255, 0.1)); /* Fallback */
    border: 1px solid var(--input-border, rgba(255, 255, 255, 0.2)); /* Fallback */
    color: var(--text-primary, white); /* Fallback */
    padding: 0.75rem;
    border-radius: var(--border-radius-sm, 0.5rem); /* Fallback */
    font-size: 0.875rem;
    transition: all var(--transition-duration, 0.3s) var(--transition-timing, ease-in-out);
    
    /* Enhanced cross-browser styling */
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'><path fill='rgba(255,255,255,0.7)' d='M6 9L1.5 4.5h9z'/></svg>");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 12px;
    padding-right: 2.5rem;
}

.control-group select:focus {
    outline: none;
    border-color: var(--input-focus, #7c3aed); /* Fallback */
    box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
}

/* ADDED: Explicit option styling for cross-browser consistency */
.control-group select option {
    background: var(--input-bg, rgba(40, 40, 40, 0.95)); /* Darker fallback for options */
    color: var(--text-primary, white);
    padding: 0.5rem;
    border: none;
}

/* Special handling for light theme options */
[data-theme="light"] .control-group select option {
    background: rgba(255, 255, 255, 0.95);
    color: rgba(0, 0, 0, 0.9);
}

/* Chrome-specific fixes */
@media screen and (-webkit-min-device-pixel-ratio:0) {
    .control-group select {
        color: var(--text-primary, white) !important;
    }
    
    .control-group select option {
        background: #2a2a2a !important; /* Dark background for Chrome */
        color: white !important;
    }
    
    [data-theme="light"] .control-group select option {
        background: #f8f9fa !important; /* Light background for light theme */
        color: #212529 !important;
    }
    
    [data-theme="current"] .control-group select option {
        background: #2a1a4a !important; /* Purple-tinted background */
        color: white !important;
    }
}

/* Firefox-specific enhancements */
@-moz-document url-prefix() {
    .control-group select {
        background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'><path fill='rgba(255,255,255,0.7)' d='M6 9L1.5 4.5h9z'/></svg>");
    }
    
    .control-group select option {
        background: var(--input-bg, rgba(40, 40, 40, 0.95));
        color: var(--text-primary, white);
    }
}

/* NEW: Compact Model Selector Styling */
.control-group select#modelSelect {
    /* Override the full-width behavior */
    width: auto !important;
    min-width: 200px; /* Ensure minimum readable width */
    max-width: 300px; /* Prevent excessive width on long model names */
    
    /* Enhanced styling for button-like appearance */
    background: var(--btn-secondary-bg, rgba(255, 255, 255, 0.1)) !important;
    border: 2px solid var(--border-primary, rgba(255, 255, 255, 0.2)) !important;
    color: var(--text-primary, white) !important;
    padding: 0.75rem 2.5rem 0.75rem 1rem !important;
    border-radius: var(--border-radius-md, 0.75rem) !important;
    font-size: 0.875rem !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all var(--transition-duration, 0.3s) var(--transition-timing, ease-in-out) !important;
    
    /* Custom dropdown arrow */
    background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><path fill='rgba(255,255,255,0.8)' d='M3 6l5 5 5-5z'/></svg>") !important;
    background-repeat: no-repeat !important;
    background-position: right 0.75rem center !important;
    background-size: 14px 14px !important;
    
    /* Enhanced appearance */
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    
    /* Center the select within its container */
    margin: 0 auto !important;
    display: block !important;
}

/* Hover and focus states for model selector */
.control-group select#modelSelect:hover {
    background: var(--btn-secondary-hover, rgba(255, 255, 255, 0.2)) !important;
    border-color: var(--border-accent, rgba(255, 255, 255, 0.3)) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
}

.control-group select#modelSelect:focus {
    outline: none !important;
    border-color: var(--input-focus, #7c3aed) !important;
    box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2) !important;
    transform: translateY(-1px) !important;
}

/* Active/open state */
.control-group select#modelSelect:active {
    transform: translateY(0) !important;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1) !important;
}

/* Model selector container adjustments */
.control-group:has(select#modelSelect) {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    gap: 0.5rem !important;
}

.control-group:has(select#modelSelect) label {
    text-align: center !important;
    margin-bottom: 0 !important;
}

/* Theme-specific adjustments for model selector */
[data-theme="light"] .control-group select#modelSelect {
    background: rgba(255, 255, 255, 0.95) !important;
    border: 2px solid rgba(0, 0, 0, 0.15) !important;
    color: rgba(0, 0, 0, 0.9) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    
    /* SINGLE arrow only - black for light theme */
    background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><path fill='%23000000' d='M3 6l5 5 5-5z'/></svg>") !important;
    background-repeat: no-repeat !important;
    background-position: right 0.75rem center !important;
    background-size: 14px 14px !important;
    
    /* Force no browser defaults */
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
}

[data-theme="light"] .control-group select#modelSelect:hover {
    background: rgba(248, 250, 252, 1) !important;
    border-color: rgba(0, 0, 0, 0.25) !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
    
    /* Keep same arrow on hover */
    background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><path fill='%23000000' d='M3 6l5 5 5-5z'/></svg>") !important;
    background-repeat: no-repeat !important;
    background-position: right 0.75rem center !important;
    background-size: 14px 14px !important;
}

[data-theme="current"] .control-group select#modelSelect {
    background: rgba(124, 58, 237, 0.1) !important;
    border: 2px solid rgba(124, 58, 237, 0.3) !important;
    box-shadow: 0 2px 8px rgba(124, 58, 237, 0.2) !important;
}

[data-theme="current"] .control-group select#modelSelect:hover {
    background: rgba(124, 58, 237, 0.2) !important;
    border-color: rgba(124, 58, 237, 0.5) !important;
    box-shadow: 0 4px 16px rgba(124, 58, 237, 0.3) !important;
}

/* Option styling for compact model selector */
.control-group select#modelSelect option {
    background: var(--select-option-bg, #2a2a2a) !important;
    color: var(--text-primary, white) !important;
    padding: 8px 12px !important;
    border: none !important;
    font-weight: 500 !important;
}

.control-group select#modelSelect option:hover,
.control-group select#modelSelect option:checked {
    background: var(--select-option-hover, #404040) !important;
}

/* Theme-specific option colors for model selector */
[data-theme="light"] .control-group select#modelSelect option {
    background: rgba(255, 255, 255, 0.98) !important;
    color: rgba(0, 0, 0, 0.9) !important;
}

[data-theme="light"] .control-group select#modelSelect option:hover,
[data-theme="light"] .control-group select#modelSelect option:checked {
    background: rgba(240, 245, 251, 1) !important;
}

[data-theme="current"] .control-group select#modelSelect option {
    background: rgba(45, 25, 75, 0.95) !important;
    color: rgba(255, 255, 255, 0.95) !important;
}

[data-theme="current"] .control-group select#modelSelect option:hover,
[data-theme="current"] .control-group select#modelSelect option:checked {
    background: rgba(75, 45, 120, 0.9) !important;
}

/* Loading state styling for model selector */
.control-group select#modelSelect:has(option[disabled][selected]) {
    opacity: 0.7 !important;
    cursor: not-allowed !important;
    animation: modelPulse 2s infinite !important;
}

@keyframes modelPulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 0.9; }
}

/* Light theme fixes for all selects */
[data-theme="light"] .control-group select {
    /* Force consistent arrow styling */
    background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'><path fill='rgba(0,0,0,0.6)' d='M6 9L1.5 4.5h9z'/></svg>") !important;
    background-repeat: no-repeat !important;
    background-position: right 0.75rem center !important;
    background-size: 12px !important;
    
    /* Ensure no browser default styling */
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
}

[data-theme="light"] .control-group select#modelSelect:focus {
    outline: none !important;
    border-color: #2563eb !important;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2) !important;
    transform: translateY(-1px) !important;
    
    /* Maintain arrow in focus state */
    background-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><path fill='%23000000' d='M3 6l5 5 5-5z'/></svg>") !important;
    background-repeat: no-repeat !important;
    background-position: right 0.75rem center !important;
    background-size: 14px 14px !important;
}
